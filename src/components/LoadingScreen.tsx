import React, { useEffect, useState } from 'react';

interface LoadingScreenProps {
  onComplete: () => void;
}

const LoadingScreen: React.FC<LoadingScreenProps> = ({ onComplete }) => {
  const [stage, setStage] = useState(0);

  useEffect(() => {
    // Stage 1: Start Line Drawing (0ms)
    setStage(1);

    // Stage 2: Fill shapes & Glow (2700ms) - Adjusted for longer drawing
    const timer2 = setTimeout(() => setStage(2), 2400);

    // Stage 3: Curtain lift / Exit (3800ms)
    const timer3 = setTimeout(() => setStage(3), 2500);

    // Complete (4500ms)
    const timer4 = setTimeout(() => onComplete(), 3200);

    return () => {
      clearTimeout(timer2);
      clearTimeout(timer3);
      clearTimeout(timer4);
    };
  }, [onComplete]);

  // The paths from the provided SVG
  const skylinePaths = [
    "M1044 2017 l-27 -24 23 -74 c13 -41 26 -78 30 -84 4 -5 24 -61 45 -122 21 -62 44 -118 51 -124 8 -6 14 -20 14 -30 0 -10 9 -43 21 -74 12 -31 19 -58 17 -61 -5 -4 -12 -2 -183 61 -188 69 -210 77 -230 86 -11 4 -77 29 -146 54 -70 25 -137 56 -150 67 -13 12 -70 66 -126 120 -108 104 -134 116 -169 77 -18 -20 -17 -24 55 -240 41 -122 82 -226 92 -235 11 -10 19 -31 19 -48 0 -17 16 -60 35 -96 19 -36 68 -132 109 -215 71 -144 113 -205 142 -205 17 0 18 -22 3 -37 -17 -17 39 -68 104 -93 33 -13 61 -29 64 -36 3 -7 -32 -68 -76 -136 -45 -67 -81 -127 -81 -134 0 -6 9 -22 19 -35 l19 -24 537 1 c511 1 538 2 556 20 10 11 55 92 99 182 49 100 86 162 93 159 7 -3 10 -11 8 -18 -2 -8 -4 -40 -3 -73 0 -45 5 -63 22 -81 21 -22 29 -24 160 -24 185 0 184 -1 180 190 -1 43 7 110 14 116 1 2 29 -34 61 -79 32 -46 80 -112 105 -148 26 -36 65 -93 88 -126 54 -81 97 -117 122 -104 11 6 24 19 30 30 11 20 -17 80 -167 360 -22 41 -67 127 -101 190 -33 63 -92 175 -131 249 -39 73 -71 137 -71 141 0 4 -14 21 -30 39 -25 26 -38 31 -76 31 -44 0 -46 1 -65 45 -24 55 -63 85 -154 118 -38 14 -131 48 -205 75 -74 28 -200 74 -280 102 -80 29 -158 59 -175 68 -16 8 -73 57 -126 110 -95 92 -117 112 -131 112 -4 0 -19 -11 -34 -23z m141 -117 l110 -109 380 -140 c209 -76 387 -142 396 -146 8 -3 31 -37 49 -75 24 -50 38 -69 49 -66 9 3 32 8 51 11 l35 6 214 -408 c118 -224 234 -443 258 -487 40 -72 45 -96 23 -96 -4 0 -135 180 -290 400 l-282 400 -155 -318 c-85 -174 -173 -354 -195 -399 l-39 -83 -534 0 c-333 0 -536 4 -540 10 -3 5 39 76 94 158 l100 149 -107 41 c-63 23 -107 45 -107 53 0 10 45 21 151 40 83 14 158 28 167 32 45 17 1 22 -169 17 -102 -3 -190 -3 -194 0 -10 6 -240 466 -240 480 0 24 33 3 159 -99 l135 -109 115 -17 c64 -10 163 -26 221 -36 57 -10 105 -17 107 -16 1 2 -166 76 -371 166 -205 89 -378 166 -384 170 -20 12 -164 443 -153 454 7 7 54 -32 144 -119 l133 -129 329 -119 c182 -66 360 -132 398 -147 37 -15 67 -25 67 -23 0 3 -22 49 -50 104 -31 62 -46 101 -39 105 10 7 63 -32 196 -140 l62 -51 133 -12 c73 -7 151 -14 173 -17 50 -6 75 -18 -289 138 l-308 132 -68 195 c-63 180 -71 210 -52 210 4 0 56 -49 117 -110z m323 -472 c17 -5 32 -13 32 -18 0 -16 -33 -11 -67 10 -35 21 -45 37 -15 25 9 -4 32 -11 50 -17z m-728 -214 c63 -31 53 -42 -21 -24 -33 8 -63 25 -92 51 l-42 39 50 -19 c28 -11 75 -32 105 -47z m1496 -225 c70 -100 85 -127 64 -114 -6 4 -61 7 -124 7 -62 0 -120 4 -127 9 -11 6 -6 24 24 86 50 101 66 125 79 121 6 -2 44 -51 84 -109z m-101 -209 l0 -65 -65 0 -65 0 -3 54 c-5 80 -2 82 70 79 l63 -3 0 -65z m160 0 l0 -65 -67 -3 -68 -3 0 71 0 71 68 -3 67 -3 0 -65z m-155 -154 l0 -64 -60 -4 c-33 -1 -65 -1 -70 0 -6 2 -10 33 -10 68 l0 64 70 0 70 0 0 -64z m160 0 c0 -35 -4 -66 -10 -68 -5 -1 -37 -1 -70 0 l-60 4 0 64 0 64 70 0 70 0 0 -64z",
    "M1110 1929 c0 -2 24 -71 53 -152 l53 -149 355 -153 356 -152 94 15 c52 9 95 17 97 18 2 1 -10 28 -26 60 l-30 59 -383 140 -384 140 -92 89 c-51 49 -93 88 -93 85z m144 -188 c3 -5 50 -25 103 -46 194 -73 249 -93 308 -113 132 -46 358 -132 370 -142 16 -13 26 -48 16 -54 -10 -6 -101 -19 -123 -18 -10 0 -44 12 -75 26 -32 13 -168 72 -302 130 -134 58 -249 106 -256 106 -20 0 -62 48 -68 78 -3 15 -9 35 -13 46 -6 16 -4 17 14 7 11 -6 23 -15 26 -20z",
    "M291 1805 c0 -5 26 -86 58 -179 l58 -169 439 -193 c241 -106 440 -197 442 -203 2 -5 -1 -11 -5 -14 -5 -3 -141 15 -303 39 l-294 45 -53 44 c-29 25 -78 66 -108 92 l-56 46 100 -194 100 -194 366 4 c323 3 365 2 365 -12 0 -11 -19 -18 -72 -27 -40 -7 -183 -31 -317 -54 l-243 -42 127 -48 127 -48 351 -24 c194 -13 355 -23 359 -21 3 1 -26 47 -66 102 -52 72 -99 158 -171 310 -54 116 -99 211 -100 212 -1 2 -203 77 -450 168 l-448 164 -81 77 c-45 43 -91 89 -103 103 -13 14 -23 22 -22 16z m131 -173 c32 -44 57 -56 363 -167 192 -70 240 -87 260 -96 11 -4 83 -31 160 -60 77 -28 146 -57 154 -63 8 -6 48 -81 88 -166 41 -85 79 -166 86 -180 6 -14 36 -62 65 -107 29 -46 51 -87 48 -92 -5 -8 -100 -6 -203 4 -28 3 -98 8 -155 11 -179 9 -272 22 -316 42 -50 22 -47 27 23 36 28 4 84 14 125 21 124 24 132 26 203 37 52 8 72 16 87 35 22 28 15 54 -19 72 -11 7 -138 8 -350 3 -182 -4 -336 -5 -341 -4 -16 6 -102 182 -89 182 6 0 25 -10 41 -22 24 -17 78 -29 242 -55 370 -59 374 -59 398 -35 15 15 19 27 14 47 -7 27 -7 27 -191 110 -97 44 -236 105 -239 105 -3 0 -33 13 -68 29 -96 44 -147 66 -218 96 -161 67 -152 59 -189 173 -16 50 -17 62 -6 62 8 0 20 -8 27 -18z",
    "M1281 1474 c44 -98 76 -145 105 -156 20 -7 38 -24 48 -45 9 -18 19 -33 23 -33 28 1 334 57 339 63 4 4 -10 7 -32 7 -21 0 -97 5 -168 12 l-129 11 -81 67 c-88 71 -111 88 -105 74z",
    "M2095 1321 c-49 -10 -212 -40 -361 -66 l-271 -49 82 -171 c54 -112 109 -208 160 -280 43 -60 78 -116 79 -125 1 -11 -8 -14 -34 -13 -19 1 -188 12 -375 23 -234 14 -355 26 -388 37 -26 8 -49 14 -51 12 -5 -6 -161 -242 -170 -257 -6 -9 96 -12 497 -12 l504 0 103 212 c57 117 158 324 225 461 88 179 118 247 106 246 -9 0 -56 -9 -106 -18z m-13 -172 c-135 -280 -244 -499 -250 -503 -15 -9 -193 273 -247 389 -30 66 -55 125 -55 132 0 15 55 27 545 111 28 5 54 5 58 1 5 -3 -18 -62 -51 -130z m-842 -534 c113 -7 278 -19 367 -25 119 -9 166 -9 182 -1 28 15 26 7 -12 -64 l-32 -60 -454 -3 c-429 -2 -453 -1 -447 15 4 10 28 51 54 91 l47 73 45 -6 c25 -3 137 -12 250 -20z",
    "M2221 1275 c-12 -30 -20 -59 -16 -65 16 -26 368 -528 386 -550 11 -14 2 9 -19 50 -86 163 -325 615 -327 617 -1 2 -12 -22 -24 -52z",
    "M1065 889 c-11 -16 -4 -17 50 -4 l50 13 -47 1 c-26 0 -50 -4 -53 -10z",
    "M2077 813 c-4 -3 -7 -21 -7 -40 0 -32 1 -33 40 -33 40 0 40 0 40 0 40 40 0 39 -1 40 -33 40 -19 0 -37 -3 -40 -7z",
    "M2230 780 c0 -39 1 -40 35 -40 34 0 35 1 35 40 0 39 -1 40 -35 40 -34 0 -35 -1 -35 -40z",
    "M2070 625 c0 -34 1 -35 40 -35 39 0 40 1 40 35 0 34 -1 35 -40 35 -39 0 -40 -1 -40 -35z",
    "M2230 625 c0 -34 1 -35 38 -35 36 0 37 1 37 35 0 34 -1 35 -37 35 -37 0 -38 -1 -38 -35z"
  ];

  return (
    <div
      className={`fixed inset-0 z-50 flex items-center justify-center bg-[#0f172a] transition-all duration-1000 ease-[cubic-bezier(0.76,0,0.24,1)]
      ${stage === 3 ? '-translate-y-full' : 'translate-y-0'}`}
    >
      <div
        className={`relative flex flex-col items-center justify-center transition-all duration-1000 transform animate-float
          ${stage === 3 ? 'opacity-0 scale-90' : 'opacity-100 scale-100'}
        `}
      >
        {/* Glow effect behind logo - Activates in Stage 2 */}
        <div className={`absolute w-80 h-80 bg-[#38bdf8]/20 blur-[100px] rounded-full transition-opacity duration-1000 ${stage >= 2 ? 'opacity-100' : 'opacity-0'}`} />

        {/* SVG Container */}
        <div className="relative w-96 h-80 mb-6">
          <svg viewBox="0 0 300 240" className="w-full h-full overflow-visible">
            <defs>
              <linearGradient id="luxury-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" stopColor="#e2e8f0" /> {/* Slate-200 */}
                <stop offset="50%" stopColor="#38bdf8" /> {/* Accent */}
                <stop offset="100%" stopColor="#e2e8f0" />
              </linearGradient>
            </defs>

            {/* Group for coordinate transform based on provided SVG */}
            <g transform="translate(0.000000,240.000000) scale(0.100000,-0.100000)">
              {/* 
                  Skyline Animation Layer
                  1. Strokes: Drawn first (fill-transparent)
                  2. Fills: Fade in later
                */}

              {/* 1. The Stroke Animation */}
              {skylinePaths.map((d, i) => (
                <path
                  key={`stroke-${i}`}
                  d={d}
                  fill="transparent"
                  stroke="url(#luxury-gradient)"
                  strokeWidth="10" // Scaled relative to the 0.1 transform (approx 1.5px visual)
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  className={`path-draw ${stage >= 2 ? 'drop-shadow-[0_0_10px_rgba(56,189,248,0.6)]' : ''}`}
                />
              ))}

              {/* 2. The Fill Animation */}
              {skylinePaths.map((d, i) => (
                <path
                  key={`fill-${i}`}
                  d={d}
                  fill="url(#luxury-gradient)"
                  stroke="none"
                  className={`fill-animation ${stage >= 2 ? 'fill-active opacity-10' : 'opacity-0'}`}
                />
              ))}
            </g>
          </svg>
        </div>

        {/* Text Animation */}
        <div className="text-center z-10 space-y-2">
          <h1 className={`text-5xl font-light tracking-[0.25em] text-white uppercase transition-all duration-1000 delay-300
            ${stage >= 1 ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'}
          `}>
            Sky<span className="font-bold text-[#38bdf8]">vera</span>
          </h1>
          <div className="h-[1px] bg-gradient-to-r from-transparent via-gray-500 to-transparent w-full mt-4" />
          <p className={`text-gray-400 text-xs tracking-[0.3em] uppercase transition-opacity duration-700 delay-700
             ${stage >= 1 ? 'opacity-100' : 'opacity-0'}
          `}>
            Elevated Living
          </p>
        </div>
      </div>
    </div>
  );
};

export default LoadingScreen;